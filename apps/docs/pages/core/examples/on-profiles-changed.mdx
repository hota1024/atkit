# `AtkitBsky#onProfilesChanged`

```ts
atkit.onProfilesChanged((profiles) => {
  // atkit.storedProfiles === profiles
  console.log('profiles', profiles)
})

atkit.getPosts({ uris: ['at://did:plc:qhnfzuuv33o7gggw6mmu2ks4/app.bsky.feed.post/3jubbmxmjy32f'] })
```

import { AtkitBsky } from '@atkit/core'
import { useCoreAtkitBsky } from '../../../contexts/CoreAtkitBskyContext'
import { ExampleContainer } from '../../../components/ExampleContainer'
import { useEffect, useState } from 'react'

export function OnProfilesChangedExample() {
  const { atkit, setAtkit } = useCoreAtkitBsky()
  const [profiles, setProfiles] = useState(atkit?.storedProfiles ?? new Map())
  const [actor, setActor] = useState('ucho-ten.net')
  const [uri, setUri] = useState('at://did:plc:qhnfzuuv33o7gggw6mmu2ks4/app.bsky.feed.post/3jubbmxmjy32f')

  useEffect(() => {
    if (!atkit) {
      return
    }

    const unsubscribe = atkit.onProfilesChanged((profiles) => {
      setProfiles(profiles)
    })

    return () => unsubscribe()
  }, [atkit])

  return (
    <div style={{ width: '100%' }}>
      <pre style={{ height: 200, overflow: 'auto', resize: 'vertical' }}>
        <code>
          stored posts: {profiles.size}
          <br />
          keys: {JSON.stringify([...profiles.keys()], null, 2)}
          <br />
          map: {JSON.stringify([...profiles], null, 2)}
        </code>
      </pre>

      <div className="nx-mb-4 nx-flex nx-gap-2" style={{ alignItems: 'center' }}>
        <label
          className="nx-block nx-text-lg nx-font-bold nx-mb-2"
          htmlFor="actor"
        >
          Handle
        </label>
        <input
          placeholder="Handle"
          className="nx-border nx-appearance-none nx-rounded nx-py-2 nx-px-3"
          name="actor"
          id="actor"
          value={actor}
          onChange={(e) => setActor(e.target.value)}
        />
        <button
          className="nx-bg-white nx-border nx-appearance-none nx-rounded nx-py-2 nx-px-3"
          style={{ color: '#202020' }}
          onClick={() => atkit.getProfile({ actor })}
        >
          Get profile
        </button>
      </div>

      <div className="nx-mb-4 nx-flex nx-gap-2" style={{ alignItems: 'center' }}>
        <label
          className="nx-block nx-text-lg nx-font-bold nx-mb-2"
          htmlFor="uri"
        >
          Post URI
        </label>
        <input
          placeholder="URI"
          className="nx-border nx-appearance-none nx-rounded nx-py-2 nx-px-3"
          name="uri"
          id="uri"
          value={uri}
          onChange={(e) => setActor(e.target.value)}
        />
        <button
          className="nx-bg-white nx-border nx-appearance-none nx-rounded nx-py-2 nx-px-3"
          style={{ color: '#202020' }}
          onClick={() => atkit.getLikes({ uri })}
        >
          Get profiles that liked
        </button>
        <button
          className="nx-bg-white nx-border nx-appearance-none nx-rounded nx-py-2 nx-px-3"
          style={{ color: '#202020' }}
          onClick={() => atkit.getRepostedBy({ uri })}
        >
          Get profiles that reposted
        </button>
      </div>
    </div>
  )
}

<ExampleContainer loginRequired>
  <OnProfilesChangedExample />
</ExampleContainer>
